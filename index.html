<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Vault-Tec Terminal Access</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<style>
:root{--ph:#7fff8a;--dim:#55b86d;--scan:rgba(0,0,0,.23);}
html,body{background:#000;margin:0}
.wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#000;
color:var(--ph);font-family:"VT323",monospace}
.term{width:min(1024px,95vw);height:min(720px,93vh);position:relative;background:#020402;border-radius:18px;
padding:24px;box-shadow:inset 0 0 40px rgba(0,0,0,.55),0 0 60px rgba(0,0,0,.8)}
.term:before{content:"";position:absolute;inset:0;border-radius:18px;pointer-events:none;
background:repeating-linear-gradient(to bottom,transparent 0px,transparent 2px,var(--scan) 3px,transparent 4px);
mix-blend-mode:soft-light;opacity:.28}
.hdr{margin:0 0 10px;letter-spacing:.08em;font-size:32px;text-transform:uppercase}
.sub{color:var(--dim);margin-bottom:10px}
.rule{height:1px;background:linear-gradient(90deg,var(--ph),transparent);opacity:.5;margin:8px 0 16px}
.menu{list-style:none;padding:0;margin:0;display:grid;gap:10px;position:relative;z-index:1}
.item{display:flex;gap:10px;align-items:center;cursor:pointer;border:1px solid rgba(127,255,138,.25);
background:rgba(8,16,8,.22);padding:10px;border-radius:8px;font-size:22px}
.item.active{outline:2px solid rgba(127,255,138,.6);background:rgba(24,48,28,.5)}
.idx{width:2.2em;text-align:center}
.badge{margin-left:auto;color:var(--dim);font-size:18px}

/* Story headers vs chapters */
.item.story{font-size:24px}
.item.story .caret{width:1.2em;display:inline-block}
.item.chapter{margin-left:32px;border-style:dashed}
.item.chapter .idx{opacity:.7}

/* Status bar */
.status{position:absolute;left:0;right:0;bottom:0;padding:10px 16px;z-index:1;color:var(--dim);
background:linear-gradient(0deg,rgba(10,20,10,.55),rgba(10,20,10,0));display:flex;justify-content:space-between;align-items:center}
.cursor{display:inline-block;width:.65em;animation:blink 1.05s steps(1,end) infinite}
@keyframes blink{50%{opacity:0}}

/* Reader toggle */
.toggle{position:absolute;top:10px;right:14px;border:1px solid rgba(127,255,138,.45);
padding:6px 10px;border-radius:6px;cursor:pointer;font-size:18px}
.toggle:hover{background:rgba(24,48,28,.5)}
body.reader{background:radial-gradient(1200px 800px at 50% 50%,#0e110f 0%,#0a0d0b 70%),#0a0d0b;color:#a8e8b7}
body.reader .term{background:#0d100e;box-shadow:inset 0 0 24px rgba(0,0,0,.7),0 0 40px rgba(0,0,0,.7)}
body.reader .term:before{opacity:.12}
body.reader .hdr{color:#a8e8b7}
body.reader .item{line-height:1.6}

/* CRT animations */
.term{animation:crtFlicker 3.8s steps(2,end) infinite}
.hdr,.item.active{ text-shadow:0 0 6px rgba(127,255,138,.25),0 0 18px rgba(127,255,138,.12); animation:glowPulse 6s ease-in-out infinite}
.term::after{content:"";position:absolute;left:0;right:0;height:2px;top:-2px;background:linear-gradient(90deg,transparent,rgba(127,255,138,.25),transparent);
opacity:.08;pointer-events:none;border-radius:18px;animation:scanRoll 7.5s linear infinite}
.cursor{text-shadow:0 0 8px rgba(127,255,138,.35)}
@keyframes crtFlicker{0%,100%{filter:none;opacity:.995}35%{opacity:1}70%{opacity:.992}}
@keyframes glowPulse{0%,100%{text-shadow:0 0 6px rgba(127,255,138,.23),0 0 16px rgba(127,255,138,.10)}
50%{text-shadow:0 0 8px rgba(127,255,138,.32),0 0 22px rgba(127,255,138,.16)}}
@keyframes scanRoll{0%{top:-2px}100%{top:100%}}
@media (prefers-reduced-motion:reduce){.term,.hdr,.item.active,.term::after,.cursor{animation:none!important}}

/* Ad / Support (optional) */
.ad-frame{border:1px solid rgba(127,255,138,.35);background:rgba(8,16,8,.22);border-radius:8px;padding:8px;margin:14px 0;box-shadow:0 0 8px rgba(127,255,138,.08) inset}
.ad-label{font-size:16px;color:var(--dim);letter-spacing:.08em;margin-bottom:6px}
.ad-slot{display:block;width:100%;min-height:90px}
.support{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
.support a{border:1px solid rgba(127,255,138,.45);padding:6px 10px;border-radius:6px;text-decoration:none;color:var(--ph);background:rgba(8,16,8,.22)}
.support a:hover{background:rgba(24,48,28,.5)}
</style>
</head>
<body>
<div class="wrap">
  <div class="term" role="application" aria-label="Vault-Tec Terminal">
    <div class="toggle" id="toggleMode">READER MODE: OFF</div>

    <div class="hdr">VAULT-TEC TERMINAL ACCESS</div>
    <div class="sub">USER: Overseer • Use ↑/↓ • ENTER to open chapter • Click titles to expand</div>
    <div class="rule"></div>

    <div class="ad-frame">
      <div class="ad-label">SPONSORED TRANSMISSION</div>
      <div class="ad-slot"></div>
    </div>

    <ul id="menu" class="menu" role="menu" aria-label="Stories & Chapters"></ul>

    <div class="ad-frame">
      <div class="ad-label">SPONSORED TRANSMISSION</div>
      <div class="ad-slot"></div>
    </div>

    <div class="support">
      <a href="https://ko-fi.com/" target="_blank" rel="noopener">☕ Buy me a coffee</a>
      <a href="https://www.patreon.com/" target="_blank" rel="noopener">♥ Patreon</a>
      <a href="mailto:you@example.com">✉ Email updates</a>
    </div>

    <div class="status" aria-live="polite">
      <div>INPUT: <span id="status">Use ↑/↓ to navigate. ENTER opens a chapter.</span></div>
      <div>READY<span class="cursor">▌</span></div>
    </div>
  </div>
</div>

<script>
/* ---- Configure your stories & chapters here ---- */
const STORIES = [
  {
    title: "No Home in the Waste",
    chapters: [
      { title: "Chapter 1 — The Road Out of New York", href: "chapter1.html" },
      // { title: "Chapter 2 — (soon)", href: "chapter2.html" },
    ]
  },
  {
    title: "HP43",
    chapters: [
      { title: "Prologue", href: "hp43.html" }
    ]
  },
  {
    title: "Shelter 21",
    chapters: [
      { title: "Short Story", href: "shelter21.html" }
    ]
  }
];

/* ---- Build the collapsible menu ---- */
const menu = document.getElementById("menu");
const statusEl = document.getElementById("status");

function buildMenu(){
  menu.innerHTML = "";
  STORIES.forEach((story, sIdx)=>{
    // Story header row
    const liStory = document.createElement("li");
    liStory.className = "item story";
    liStory.setAttribute("role","menuitem");
    liStory.dataset.type = "story";
    liStory.dataset.index = sIdx;
    liStory.innerHTML = `<span class="idx">[–]</span><span class="caret">▶</span><span class="title">${story.title}</span><span class="badge">${story.chapters.length} ch.</span>`;
    menu.appendChild(liStory);

    // Chapter rows (start hidden)
    story.chapters.forEach((ch, cIdx)=>{
      const liCh = document.createElement("li");
      liCh.className = "item chapter";
      liCh.setAttribute("role","menuitem");
      liCh.dataset.type = "chapter";
      liCh.dataset.s = sIdx;
      liCh.dataset.c = cIdx;
      liCh.style.display = "none";
      liCh.innerHTML = `<span class="idx">[${cIdx+1}]</span><span class="title">${ch.title}</span>`;
      menu.appendChild(liCh);
    });
  });
}
buildMenu();

/* ---- Expand / collapse ---- */
function toggleStory(sIdx){
  const rows = [...menu.querySelectorAll('.item.chapter')].filter(el => +el.dataset.s === +sIdx);
  const header = [...menu.querySelectorAll('.item.story')][sIdx];
  const open = rows[0] && rows[0].style.display !== "none";
  rows.forEach(el => el.style.display = open ? "none" : "flex");
  if(header){
    const caret = header.querySelector(".caret");
    if(caret) caret.textContent = open ? "▶" : "▾";
  }
}

/* ---- Click handling ---- */
menu.addEventListener("click",(e)=>{
  const li = e.target.closest(".item");
  if(!li) return;
  if(li.dataset.type === "story"){
    toggleStory(li.dataset.index);
    setActiveFirstVisible();
  }else if(li.dataset.type === "chapter"){
    openChapter(li);
  }
});

/* ---- Keyboard navigation over visible chapter rows only ---- */
function visibleChapters(){
  return [...menu.querySelectorAll('.item.chapter')].filter(el => el.style.display !== "none");
}
let activeIdx = 0;
function setActive(idx){
  const vis = visibleChapters();
  if(vis.length === 0) return;
  activeIdx = (idx + vis.length) % vis.length;
  vis.forEach((el,i)=> el.classList.toggle("active", i===activeIdx));
  const t = vis[activeIdx].querySelector(".title")?.textContent || "";
  statusEl.textContent = "Selected: " + t;
}
function setActiveFirstVisible(){
  setActive(0);
}
function openChapter(el){
  const s = +el.dataset.s, c = +el.dataset.c;
  const href = STORIES[s].chapters[c].href;
  if(href) window.location.href = href;
}
window.addEventListener("keydown",(e)=>{
  const vis = visibleChapters();
  if(e.key === "ArrowDown"){ setActive(activeIdx+1); }
  if(e.key === "ArrowUp"){ setActive(activeIdx-1); }
  if(e.key === "Enter" && vis.length){ openChapter(vis[activeIdx]); }
  if(/^[1-9]$/.test(e.key)){
    const n = (+e.key)-1;
    if(vis[n]){ setActive(n); openChapter(vis[n]); }
  }
});

/* Start with first story expanded */
toggleStory(0);
setActiveFirstVisible();

/* Reader Mode */
const t=document.getElementById('toggleMode');
const pref=localStorage.getItem('readerMode')==='1';
if(pref) document.body.classList.add('reader');
t.textContent='READER MODE: '+(document.body.classList.contains('reader')?'ON':'OFF');
t.addEventListener('click',()=>{
  document.body.classList.toggle('reader');
  const on=document.body.classList.contains('reader');
  t.textContent='READER MODE: '+(on?'ON' : 'OFF');
  localStorage.setItem('readerMode', on ? '1' : '0');
});
</script>
</body>
</html>
